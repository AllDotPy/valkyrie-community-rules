
id: "aws-secrets-001"
name: "AWS Access Key Detection"
description: "Detects AWS access keys in source code"
category: "secrets"
severity: "critical"
author: "Valkyrie Community"
version: "1.0.0"
tags:
  - "aws"
  - "credentials"
  - "secrets"
enabled: true

# Pattern definitions
patterns:
  - pattern: 'AKIA[0-9A-Z]{16}'
    name: "AWS Access Key ID pattern"
    entropy_threshold: 0.0
    keywords: ["aws", "amazon", "access", "key"]
  
  - pattern: '[A-Za-z0-9/+=]{40}'
    name: "AWS Secret Access Key pattern"
    entropy_threshold: 4.5
    keywords: ["secret", "aws"]

# File type restrictions
file_extensions:
  - ".py"
  - ".js"
  - ".java"
  - ".go"
  - ".rs"
  - ".yaml"
  - ".yml"
  - ".json"
  - ".env"

# Exclude patterns to reduce false positives
exclude_patterns:
  - "test.*"
  - "example.*"
  - ".*demo.*"

remediation: |
  AWS credentials should never be hardcoded in source code.
  
  Recommended solutions:
  1. Use AWS IAM roles for EC2 instances
  2. Use environment variables
  3. Use AWS Secrets Manager or Parameter Store
  4. Use AWS credential files with proper permissions

references:
  - "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
  - "https://docs.aws.amazon.com/secretsmanager/"
